
设计模式
关于改善代码质量的小建议

1.关于命名
	命名的关键是能准确达意。
	对于不同作用域的命名，我们可以适当地选择不同的长度。
	我们可以借助类的信息来简化属性、函数的命名，利用函数的信息来简化函数参数的命名。
	命名要可读、可搜索。不要使用生僻的、不好读的英文单词来命名。
	命名要符合项目的统一规范，也不要用些反直觉的命名。
	接口有两种命名方式：一种是在接口中带前缀“I”；另一种是在接口的实现类中带后缀“Impl”。
	对于抽象类的命名，也有两种方式，一种是带上前缀“Abstract”，一种是不带前缀。
	这两种命名方式都可以，关键是要在项目中统一。
	
2.关于注释
	注释的内容主要包含这样三个方面：做什么、为什么、怎么做。
	对于一些复杂的类和接口，我们可能还需要写明“如何用”。
	类和函数一定要写注释，而且要写得尽可能全面详细。
	函数内部的注释要相对少一些，一般都是靠好的命名、提炼函数、解释性变量、总结性注释来提高代码可读性。

3.关于代码风格
	函数、类多大才合适？函数的代码行数不要超过一屏幕的大小，比如 50 行。
	类的大小限制比较难确定。一行代码多长最合适？最好不要超过 IDE 的显示宽度。
	当然，也不能太小，否则会导致很多稍微长点的语句被折成两行，也会影响到代码的整洁，不利于阅读。
	善用空行分割单元块。对于比较长的函数，为了让逻辑更加清晰，可以使用空行来分割各个代码块。
	四格缩进还是两格缩进？我个人比较推荐使用两格缩进，这样可以节省空间，尤其是在代码嵌套层次比较深的情况下。 
	大括号是否要另起一行？将大括号放到跟上一条语句同一行，可以节省代码行数。
	但是将大括号另起新的一行的方式，左右括号可以垂直对齐，哪些代码属于哪一个代码块，更加一目了然。
	类中成员怎么排列？在 Google Java 编程规范中，依赖类按照字母序从小到大排列。
	类中先写成员变量后写函数。成员变量之间或函数之间，先写静态成员变量或函数，后写普通变量或函数，并且按照作用域大小依次排列。
	
4. 关于编码技巧
	将复杂的逻辑提炼拆分成函数和类。
	通过拆分成多个函数或将参数封装为对象的方式，来处理参数过多的情况。
	函数中不要使用参数来做代码执行逻辑的控制。函数设计要职责单一。
	移除过深的嵌套层次，方法包括：去掉多余的 if 或 else 语句，
	使用 continue、break、return 关键字提前退出嵌套，
	调整执行顺序来减少嵌套，将部分嵌套逻辑抽象成函数。
	用字面常量取代魔法数。用解释性变量来解释复杂表达式，以此提高代码可读性。
	
5. 统一编码规范
	除了这三节讲到的比较细节的知识点之外，
	最后，还有一条非常重要的，那就是，项目、团队，甚至公司，一定要制定统一的编码规范，
	并且通过 Code Review 督促执行，这对提高代码质量有立竿见影的效果。	
	
 我们可以参考之前讲过的代码质量评判标准，看这段代码是否可读、可扩展、可维护、灵活、简洁、可复用、可测试等等。
	落实到具体细节，我们可以从以下几个方面来审视代码。
	
	1.目录设置是否合理、模块划分是否清晰、代码结构是否满足“高内聚、松耦合”？
	2.是否遵循经典的设计原则和设计思想（SOLID、DRY、KISS、YAGNI、LOD 等）？
	3.设计模式是否应用得当？是否有过度设计？
	4.代码是否容易扩展？如果要添加新功能，是否容易实现？
	5.代码是否可以复用？是否可以复用已有的项目代码或类库？是否有重复造轮子？
	6.代码是否容易测试？单元测试是否全面覆盖了各种正常和异常的情况？
	7.代码是否易读？是否符合编码规范（比如命名和注释是否恰当、代码风格是否一致等）？
	
多问能否实现下面的问题：
	代码是否实现了预期的业务需求？
	逻辑是否正确？是否处理了各种异常情况？
	日志打印是否得当？是否方便 debug 排查问题？接口是否易用？
	是否支持幂等、事务等？代码是否存在并发问题？是否线程安全？
	性能是否有优化空间，比如，SQL、算法是否可以优化？
	是否有安全漏洞？比如输入输出校验是否全面？
	
	
重构四步走
	第一轮重构：提高代码的可读性
	第二轮重构：提高代码的可测试性
	第三轮重构：编写完善的单元测试
	第四轮重构：所有重构完成之后添加注释
	
重构思想
	1.	即便是非常简单的需求，不同水平的人写出来的代码，差别可能会很大。我们要对代码质量有所追求，不能只是凑活能用就好。
		花点心思写一段高质量的代码，比写 100 段凑活能用的代码，对你的代码能力提高更有帮助。
		
	2.	知其然知其所以然，了解优秀代码设计的演变过程，比学习优秀设计本身更有价值。
		知道为什么这么做，比单纯地知道怎么做更重要，这样可以避免你过度使用设计模式、思想和原则。
		
	3.	设计思想、原则、模式本身并没有太多“高大上”的东西，都是一些简单的道理，而且知识点也并不多，
		关键还是锻炼具体代码具体分析的能力，把知识点恰当地用在项目中。
		
	4.	高手之间的竞争都是在细节。大的架构设计、分层、分模块思路实际上都差不多。
		没有项目是靠一些不为人知的设计来取胜的，即便有，很快也能被学习过去。
		所以，关键还是看代码细节处理得够不够好。这些细节的差别累积起来，会让代码质量有质的差别。
		所以，要想提高代码质量，还是要在细节处下功夫。
	
	
程序出错该返回啥？NULL、异常、错误码、空对象？
	返回具体的异常信息
	1.直接吞掉。
		如果 func1() 抛出的异常是可以恢复，且 func2() 的调用方并不关心此异常，
		我们完全可以在 func2() 内将 func1() 抛出的异常吞掉；
	2.原封不动地 re-throw。
		如果 func1() 抛出的异常对 func2() 的调用方来说，也是可以理解的、关心的 ，
		并且在业务概念上有一定的相关性，我们可以选择直接将 func1 抛出的异常 re-throw；
	3.包装成新的异常 re-throw。
		如果 func1() 抛出的异常太底层，对 func2() 的调用方来说，缺乏背景去理解、且业务概念上无关，
		我们可以将它重新包装成调用方可以理解的新异常，然后 re-throw。
		
	答：	总之，是否往上继续抛出，要看上层代码是否关心这个异常。关心就将它抛出，否则就直接吞掉。
		是否需要包装成新的异常抛出，看上层代码是否能理解这个异常、是否业务相关。
		如果能理解、业务相关就可以直接抛出，否则就封装成新的异常抛出。
